{{/*
Purpose: Homepage for shawnyeager.com - Essays-forward with intro

Sections:
1. Hero - Headline, subhead, CTAs, sector tags
2. Intro - Who I am and why frontier tech
3. Essays - Horizontal layout (date + content)
4. Assessment - GTM assessment CTA
5. Signup - Email newsletter
6. Footer

Important Notes:
- Content comes from /content/_index.md frontmatter
- Overrides theme default index.html
*/}}

{{ define "main" }}
<div class="landing-page">

    <!-- Hero -->
    <section class="landing-hero">
        <div class="landing-hero-content">
            <h1 class="landing-headline">{{ .Params.hero_headline | safeHTML }}</h1>
            <p class="landing-subhead">{{ .Params.hero_subhead }}</p>
            <div class="hero-ctas">
                {{ with .Params.hero_cta }}
                <a href="{{ .url }}" class="btn-solid btn-solid--primary">
                    <span class="link-text">{{ .text }}</span><span class="arrow" aria-hidden="true">→</span>
                </a>
                {{ end }}
                {{ with .Params.hero_secondary }}
                <a href="{{ .url }}" class="hero-secondary-link">
                    <span class="link-text">{{ .text }}</span><span class="arrow" aria-hidden="true">→</span>
                </a>
                {{ end }}
            </div>
            {{ with .Params.sector_tags }}
            <p class="sector-tags">{{ . | safeHTML }}</p>
            {{ end }}
        </div>
    </section>

    <!-- Intro -->
    {{ with .Params.intro }}
    <section class="landing-section intro-section">
        {{ range .paragraphs }}
        <p>{{ . | safeHTML }}</p>
        {{ end }}
    </section>
    {{ end }}

    <!-- Essays -->
    {{ $posts := where .Site.RegularPages "Type" "essays" }}
    {{ if not hugo.IsServer }}
    {{ $posts = where $posts "Draft" false }}
    {{ end }}
    {{ if $posts }}
    <section class="landing-section essays-section">
        <h2 class="landing-section-label">{{ with .Params.essays.label }}{{ . }}{{ else }}Recent Essays{{ end }}</h2>
        {{ with .Params.essays.intro }}<p class="section-subhead">{{ . }}</p>{{ end }}

        <div class="essay-list">
            {{ range first 4 $posts }}
            <article class="essay-item">
                <time datetime="{{ .Date.Format "2006-01-02" }}" class="essay-date">{{ .Date.Format "Jan 2006" }}</time>
                <div class="essay-content">
                    <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                    <p>{{ .Description }}</p>
                </div>
            </article>
            {{ end }}
        </div>

        <div class="all-essays">
            {{- partial "links/action.html" (dict "url" ("essays" | relURL) "text" "All essays" "event" .Site.Params.plausible_events.all_essays) -}}
        </div>
    </section>
    {{ end }}

    <!-- GTM Assessment -->
    {{ with .Params.assessment }}
    <section class="landing-section assessment-section">
        <h2>{{ .headline }}</h2>
        <p>{{ .description }}</p>
        {{- partial "links/action.html" (dict "url" .url "text" .cta_text) -}}
    </section>
    {{ end }}

    <!-- Email Signup -->
    {{ if .Site.Params.show_email_signup }}
    <section class="landing-section signup-section">
        <p>{{ with .Params.signup_text }}{{ . }}{{ else }}New essays and updates, occasionally.{{ end }}</p>
        <form class="signup-form" action="{{ .Site.Params.email_signup_action }}" method="post" target="popupwindow">
            <label for="signup-email" class="sr-only">Email address</label>
            <input type="email" id="signup-email" name="email" placeholder="Email address" required autocomplete="email" inputmode="email">
            <button type="submit" class="btn-ghost btn-ghost--muted{{ with .Site.Params.plausible_form_event }} plausible-event-name={{ . }}{{ end }}">Subscribe</button>
        </form>
    </section>
    {{ end }}

</div>
{{ end }}
